{% extends "base.html" %}

{% block content %}
<!-- Contacts List Section -->
<div class="col-12 col-md-4 col-lg-5 col-xl-3 px-0 contacts-list">
  <div class="messages-page__header mb-0 px-4 pt-3 pb-3">
    <span class="messages-page__title">Chats</span>
    <div class="messages-page__dark-mode-toogler">
      <svg xmlns="http://www.w3.org/2000/svg" class="svg-icon svg-icon--dark-mode" viewBox="0 0 49.7 49.7">
        <path d="M25.4,49.7A25.6,25.6,0,0,1,1.3,32.3,25.6,25.6,0,0,1,17.3.1a2,2,0,0,1,2.1.5,2.2,2.2,0,0,1,.5,2.1,19.9,19.9,0,0,0-1.2,6.8A21,21,0,0,0,25,24.7,21,21,0,0,0,40.2,31h0a20.9,20.9,0,0,0,6.9-1.2,2,2,0,0,1,2.5,2.5,25.8,25.8,0,0,1-16,16.1A28.7,28.7,0,0,1,25.4,49.7Z" fill="currentColor"/>
      </svg>
    </div>
  </div>

  <div class="contacts-container">
    {% for contact in contacts %}
    <div class="contact-item" data-contact="{{ contact.contact }}">
      <div class="contact-avatar">
        <img src="https://ui-avatars.com/api/?name={{ contact.contact }}&background=random" alt="{{ contact.contact }}">
      </div>
      <div class="contact-info">
        <div class="contact-name">{{ contact.contact }}</div>
        <div class="contact-last-message">{{ contact.text }}</div>
        <div class="contact-time" data-time="{{ contact.time.isoformat() }}">
          {{ contact.time.strftime('%H:%M') }}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Chat Section -->
<div class="col-12 col-md-8 col-lg-7 col-xl-9 px-0 chat-section">
  <div class="chat-container d-none d-md-flex flex-column">
    <div class="messages-page__header mb-0 px-4 pt-3 pb-3">
      <div class="d-flex align-items-center">
        <button class="btn btn-link back-button d-md-none">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <span class="messages-page__title ms-2">Messages</span>
      </div>
    </div>

    <div class="chat__content pt-4 px-3">
      <div class="messages-list">
        {% for message in messages %}
          <div class="message-bubble {% if message.sender == 'You' %}message-bubble--outgoing{% else %}message-bubble--incoming{% endif %}">
            <div class="message-header">
              <span class="message-sender">{{ message.sender }}</span>
              <span class="message-time" data-time="{{ message.time.isoformat() }}">
                {{ message.time.strftime('%H:%M') }}
              </span>
            </div>
            <div class="message-text">
              {{ message.text }}
            </div>
            {% if message.location %}
            <div class="message-location">
              üìç {{ message.location }}
            </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>

    <div class="message-input-container">
      <form class="message-form" action="/send" method="post">
        <div class="input-group">
          <button type="button" class="btn btn-link btn-emoji">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
              <line x1="9" y1="9" x2="9.01" y2="9"></line>
              <line x1="15" y1="9" x2="15.01" y2="9"></line>
            </svg>
          </button>
          <input type="text" class="form-control" placeholder="Message" name="message" autocomplete="off">
          <button type="submit" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
